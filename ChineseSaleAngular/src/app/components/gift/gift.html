<div class="giftList">
    @for(gift of allGifts; track gift.id) {
        <nz-card style="width:300px;" [nzCover]="coverTemplate" [nzActions]="[rightAction, middleAction, leftAction]">
            <nz-card-meta nzTitle={{gift.name}} nzDescription="₪{{gift.giftValue}} :שווי המתנה"></nz-card-meta>
        </nz-card>
        @if (gift.price > 10) {
            <nz-card-meta>לא ניתן לצרף מתנה זו לחבילה</nz-card-meta>
        }
        
        <ng-template #avatarTemplate>
            <nz-avatar nzSrc="http://localhost:5025/images/gift.png"></nz-avatar>
        </ng-template>
        
        <ng-template #coverTemplate>
            <img alt="example" src="http://localhost:5025/images/gift.png" />
        </ng-template>
        
        <ng-template #rightAction>
            @if(admin){
                <nz-icon nzType="delete" nzTheme="outline" />
            }
            @else {
                <nz-icon nzType="minus" nzTheme="outline" (click)="updateGift(gift.id, -1)"></nz-icon>
            }
        </ng-template>
        
        <ng-template #middleAction>
            @if(!admin){
                {{
                    getGiftQuantity(gift.id)
                }}
    }
    
</ng-template>

<ng-template #leftAction>
    @if(admin){
        <nz-icon nzType="edit" />
    }
    @else {
        <nz-icon nzType="plus" nzTheme="outline" (click)="updateGift(gift.id, 1)"></nz-icon>
    }
</ng-template>
}
</div>



@if(admin){
<button nz-button nzType="primary" (click)="showModal2()">
    <span>הוסף מתנה</span>
</button>
}


<nz-modal [(nzVisible)]="isVisible" nzTitle="הוספת חבילה" (nzOnCancel)="handleCancel()">
    <div *nzModalContent>
        <form nz-form [formGroup]="validateForm" (ngSubmit)="submitForm()">
            <nz-form-item>
                <nz-form-label [nzSpan]="7" nzRequired>שם</nz-form-label>
                <nz-form-control [nzSpan]="12" nzHasFeedback nzValidatingTip="Validating..."
                    [nzErrorTip]="userErrorTpl">
                    <input nz-input formControlName="name" />
                    <ng-template #userErrorTpl let-control>
                        @if (control.errors?.['required']) {
                        Please input name!
                        }
                    </ng-template>
                </nz-form-control>
            </nz-form-item>
            <nz-form-item>
                <nz-form-label [nzSpan]="7">תאור</nz-form-label>
                <nz-form-control [nzSpan]="12" nzHasFeedback>
                    <input nz-input formControlName="description" />
                </nz-form-control>
            </nz-form-item>
            <nz-form-item>
                <nz-form-label [nzSpan]="7" nzRequired>מחיר</nz-form-label>
                <nz-form-control [nzSpan]="12" nzHasFeedback nzErrorTip="Please input price!">
                    <input nz-input formControlName="price" />
                </nz-form-control>
            </nz-form-item>
            <nz-form-item>
                <nz-form-label [nzSpan]="7" nzRequired>שווי המתנה</nz-form-label>
                <nz-form-control [nzSpan]="12" nzHasFeedback nzErrorTip="Please input gift value!">
                    <input nz-input formControlName="giftValue" />
                </nz-form-control>
            </nz-form-item>
            <nz-form-item>
                <nz-form-label [nzSpan]="7">תמונה</nz-form-label>
                <nz-form-control [nzSpan]="12" nzHasFeedback>
                    <input nz-input formControlName="imageUrl" />
                </nz-form-control>
            </nz-form-item>
            <nz-form-item>
                <nz-form-label [nzSpan]="7" nzRequired>קטגוריה</nz-form-label>
                <nz-form-control [nzSpan]="12" nzHasFeedback nzErrorTip="Please input category!">
                    <input nz-input formControlName="categoryId" />
                </nz-form-control>
            </nz-form-item>
            <nz-form-item>
                <nz-form-label [nzSpan]="7" nzRequired>תורם</nz-form-label>
                <nz-form-control [nzSpan]="12" nzHasFeedback nzErrorTip="Please input donor!">
                    <input nz-input formControlName="donorId" />
                </nz-form-control>
            </nz-form-item>


            <nz-form-item>
                <nz-form-control [nzOffset]="7" [nzSpan]="12">
                    <button nz-button nzType="primary" [disabled]="!validateForm.valid" (click)="handleOk()"
                        [nzLoading]="isConfirmLoading">אישור</button>
                    <button nz-button nzType="default" (click)="resetForm($event)"
                        (click)="handleCancel()">ביטול</button>
                </nz-form-control>
            </nz-form-item>
        </form>
    </div>
    <div *nzModalFooter>
    </div>
</nz-modal>
